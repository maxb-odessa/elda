#
# simple elda config
#
# block must start with bare keyword
# block data must start with blank
#
#              
#

source
    handler terminal
    name JOYIN

source
    name JOURNAL
    handler filein
    var dir @HOME@/.ed/journal/
    var mask ^Journal\.\d+\.\d+\.log$

#action
#    name LOGFILE
#    handler fileout
#    var path @HOME@/.ed/elda-go.log
#    var truncate yes
#    var create yes

action
    name JOYOUT
    handler terminal

source
    name TICK10S
    handler ticker
    var interval 10
    var message tick 10 seconds

#source
#    name PIPE
#    handler pipein
#    var path /tmp/elda-go-out.pipe

action
    name EDPAD
    handler fileout
    var path /tmp/ed.pipe
    var pipe yes
    var create yes


# $0 = whole match string, $1..$9 = submatches (if any)

event
    source JOURNAL "event":"FSSDiscoveryScan".+"BodyCount":([0-9]+), "NonBodyCount":([0-9]+),
    action JOYOUT   mfd 3 "Signals: $1/$2"
    action JOYOUT   update
    action EDPAD    view3 Signals: $1/$2\n

event
    source TICK10S tick 10 seconds
    action JOYOUT   clock local 24hr ddmmyy
    action JOYOUT   update

event
    source JOURNAL "event":"FSDJump", "Taxi":false,
    action JOYOUT   bri led 30%
    action JOYOUT   bri mfd 30%
    action JOYOUT   update

event
    source JOURNAL "JumpType":"Hyperspace", "StarSystem":"([a-zA-Z -]+) ([a-zA-Z]{1}\d+-?\d*)",.+"StarClass":"(\w)"
    action JOYOUT   mfd 2 " $3,$2"
    action JOYOUT   bri led 5%
    action JOYOUT   bri mfd 5%
    action JOYOUT   update

event
    source JOURNAL "event":"FSDTarget", "Name":"([a-zA-Z -]+) ([a-zA-Z]{1}\d+-?\d*)", .+"StarClass":"(.+)", "RemainingJumpsInRoute":(\d+)
    action JOYOUT   mfd 1 "~$3,$2 ($4)"
    action JOYOUT   mfd 3 "not scanned"
    action JOYOUT   update
    action EDPAD    view1 Next Jump: $3, $2, Jumps left: $4\n

event
    source JOURNAL "event":"Scan", "ScanType":".+", "BodyName":"([a-zA-Z -]+) ([a-zA-Z]{1}\d+-?\d*)(| [aA]+)", .+"StarType":"(\w+)", "Subclass":(\d+), .+"WasDiscovered":(\w+), "
    action JOYOUT   mfd 2 " $4,$2,$6"
    action JOYOUT   update
    action EDPAD    view2 \n
    action EDPAD    view2 Name:       $1 $2\n
    action EDPAD    view2 Discovered: $6\n
    action EDPAD    view2 Class:      $4$5\n

event
    source JOURNAL "event":"Scan", "ScanType":".+", "BodyName":"([a-zA-Z -]+) ([a-zA-Z]{1}\d+-?\d*) [0-9b-zB-Z ]+", .+"StarType":"(\w+)", "Subclass":(\d+), .+"WasDiscovered":(\w+), "
    action EDPAD    view2 Satellite:  $3$4\n

event
    source JOURNAL "event":"DockingGranted",
    action JOYOUT   blink on
    action JOYOUT   update

event
    source JOURNAL "event":"Docked",
    action JOYOUT   blink off
    action JOYOUT   update

event
    source JOURNAL "event":"SAASignalsFound", "BodyName":"(.+)", "SystemAddress":.+"Signals":\[.+"Guardian", "Count":(\d+)
    action EDPAD    view3 Body: $1, Guardian signals: $2\n

event
    source JOURNAL "event":"SAASignalsFound", "BodyName":"(.+)", "SystemAddress":.+"Signals":\[.+"Human", "Count":(\d+)
    action EDPAD    view3 Body: $1, Human signals: $2\n

event
    source JOURNAL "event":"FSSSignalDiscovered",.+"SignalName_Localised":\s?"Nonhuman signal source",
    action EDPAD    view3 NonHuman signal found\n

event
    source JOURNAL "event":"FSSSignalDiscovered",.+"SignalName_Localised":\s?"Notable stellar phenomena"
    action EDPAD    view3 Stellar Phenomena found\n

event
    source JOURNAL "event":"FSSSignalDiscovered",.+"SignalName_Localised":\s?"CAPITAL SHIP"
    action EDPAD    view3 Capital Ship detected\n

event
    source JOYIN ^CONNECTED$
    action EDPAD    view1 Yep, Connected!\n
    action EDPAD    view2 Connected!\n
    action EDPAD    view3 Indeed, Connected!\n
    action JOYOUT   mfd 1 "Hello,"
    action JOYOUT   mfd 2 " commander"
    action JOYOUT   mfd 3 "  Vessae!"
    action JOYOUT   bri led 30% 
    action JOYOUT   bri mfd 30%
    action JOYOUT   blink off
    action JOYOUT   led a red
    action JOYOUT   led b red
    action JOYOUT   led d red
    action JOYOUT   led t1 green
    action JOYOUT   led t2 red
    action JOYOUT   led t3 amber
    action JOYOUT   clock local 24hr ddmmyy
    action JOYOUT   update

